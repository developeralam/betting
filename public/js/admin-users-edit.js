(self.webpackChunk=self.webpackChunk||[]).push([[8313],{69378:(e,r,t)=>{"use strict";function n(e){return Array.isArray(e)}function a(e,r,t){return r=r||new FormData,void 0===e||(n(e)?e.forEach((function(e){a(e,r,t+"[]")})):!function(e){return e===Object(e)}(e)||function(e){return e instanceof File}(e)||function(e){return e instanceof Date}(e)?r.append(t,e):Object.keys(e).forEach((function(s){var i=e[s];if(n(i))for(;s.length>2&&s.lastIndexOf("[]")===s.length-2;)s=s.substring(0,s.length-2);a(i,r,t?t+"["+s+"]":s)}))),r}t.d(r,{Z:()=>a})},24431:(e,r,t)=>{"use strict";t.d(r,{Z:()=>o});var n=t(94015),a=t.n(n),s=t(23645),i=t.n(s)()(a());i.push([e.id,".v-avatar[data-v-5ff4869d]{cursor:pointer}","",{version:3,sources:["webpack://./resources/js/components/Admin/FileUpload.vue"],names:[],mappings:"AAmJA,2BACA,cACA",sourcesContent:['<template>\r\n  <div>\r\n    <v-text-field\r\n      :value="path"\r\n      :label="label"\r\n      :disabled="disabled || form.busy"\r\n      append-icon="mdi-paperclip"\r\n      :append-outer-icon="preview && clearable ? \'mdi-delete\' : \'\'"\r\n      outlined\r\n      readonly\r\n      :error="!!error"\r\n      :error-messages="error"\r\n      @click:append="$refs.input.click()"\r\n      @click:append-outer="clear"\r\n    >\r\n      <template v-slot:prepend-inner>\r\n        <v-avatar height="28" width="auto" max-width="56" tile @click="!disabled && $refs.input.click()">\r\n          <img v-if="isImage && preview" :src="preview" :alt="label" :disabled="disabled || form.busy">\r\n          <v-icon v-else :disabled="disabled || form.busy">\r\n            mdi-image-outline\r\n          </v-icon>\r\n        </v-avatar>\r\n      </template>\r\n      <template v-slot:append-outer>\r\n        <slot name="append-outer" />\r\n      </template>\r\n    </v-text-field>\r\n\r\n    <input ref="input" type="file" class="d-none" :accept="accept" @change="uploadFile">\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Form from \'vform\'\r\nimport objectToFormData from \'~/plugins/objectToFormData\'\r\n\r\nexport default {\r\n  props: {\r\n    label: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    value: {\r\n      validator: value => typeof value === \'string\' || value === null,\r\n      required: true\r\n    },\r\n    accept: {\r\n      type: String,\r\n      required: false,\r\n      default: \'image/*\'\r\n    },\r\n    name: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    folder: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    clearable: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: false\r\n    },\r\n    disabled: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: false\r\n    }\r\n  },\r\n\r\n  data () {\r\n    return {\r\n      error: null,\r\n      imageBase64: null,\r\n      form: new Form({\r\n        file: null,\r\n        name: this.name,\r\n        folder: this.folder\r\n      }),\r\n      uploadedFilePath: null\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    path () {\r\n      return this.form.busy\r\n        ? this.$t(\'Uploading...\')\r\n        : ((!this.uploadedFilePath && !this.value) || this.uploadedFilePath === \'\'\r\n          ? this.$t(\'Upload a file\')\r\n          : (this.uploadedFilePath || this.displayValue))\r\n    },\r\n    preview () {\r\n      return this.imageBase64 || this.displayValue\r\n    },\r\n    displayValue () {\r\n      return this.value && !this.value.match(/\\//) ? `/storage/${this.folder}/${this.value}` : this.value\r\n    },\r\n    isImage () {\r\n      // const extension = (this.uploadedFilePath || this.displayValue).split(\'/\').pop().toLowerCase()\r\n      const file = this.uploadedFilePath || this.displayValue\r\n      const extension = file && file.substring(file.lastIndexOf(\'.\') + 1)\r\n      return [\'png\', \'gif\', \'jpg\', \'jpeg\', \'svg\', \'tiff\'].indexOf(extension) > -1\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    uploadedFilePath (uploadedFilePath) {\r\n      this.$emit(\'input\', uploadedFilePath)\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    clear () {\r\n      this.uploadedFilePath = \'\'\r\n      this.imageBase64 = null\r\n    },\r\n    async uploadFile (event) {\r\n      this.error = null\r\n\r\n      this.form.file = event.target.files[0]\r\n\r\n      if (this.form.file) {\r\n        let imageBase64\r\n        const reader = new FileReader()\r\n        // define a callback function to run, when FileReader finishes its job\r\n        reader.onload = e => { imageBase64 = e.target.result }\r\n        // Start the reader job - read file as a data url (base64 format)\r\n        reader.readAsDataURL(this.form.file)\r\n\r\n        const options = { transformRequest: [(data, headers) => objectToFormData(data)] }\r\n\r\n        const { data } = await this.form.submit(\'post\', \'/api/admin/files\', options)\r\n\r\n        if (data.success) {\r\n          this.uploadedFilePath = data.path\r\n\r\n          this.imageBase64 = imageBase64\r\n        } else {\r\n          this.error = data.message\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n<\/script>\r\n<style scoped>\r\n.v-avatar {\r\n  cursor: pointer;\r\n}\r\n</style>\r\n'],sourceRoot:""}]);const o=i},90304:(e,r,t)=>{"use strict";t.d(r,{Z:()=>u});var n=t(87757),a=t.n(n),s=t(50175),i=t.n(s),o=t(69378);function l(e,r,t,n,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void t(e)}o.done?r(l):Promise.resolve(l).then(n,a)}const u={props:{label:{type:String,required:!0},value:{validator:function(e){return"string"==typeof e||null===e},required:!0},accept:{type:String,required:!1,default:"image/*"},name:{type:String,required:!0},folder:{type:String,required:!0},clearable:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1}},data:function(){return{error:null,imageBase64:null,form:new(i())({file:null,name:this.name,folder:this.folder}),uploadedFilePath:null}},computed:{path:function(){return this.form.busy?this.$t("Uploading..."):!this.uploadedFilePath&&!this.value||""===this.uploadedFilePath?this.$t("Upload a file"):this.uploadedFilePath||this.displayValue},preview:function(){return this.imageBase64||this.displayValue},displayValue:function(){return this.value&&!this.value.match(/\//)?"/storage/".concat(this.folder,"/").concat(this.value):this.value},isImage:function(){var e=this.uploadedFilePath||this.displayValue,r=e&&e.substring(e.lastIndexOf(".")+1);return["png","gif","jpg","jpeg","svg","tiff"].indexOf(r)>-1}},watch:{uploadedFilePath:function(e){this.$emit("input",e)}},methods:{clear:function(){this.uploadedFilePath="",this.imageBase64=null},uploadFile:function(e){var r,t=this;return(r=a().mark((function r(){var n,s,i,l,u;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.error=null,t.form.file=e.target.files[0],!t.form.file){r.next=12;break}return(s=new FileReader).onload=function(e){n=e.target.result},s.readAsDataURL(t.form.file),i={transformRequest:[function(e,r){return(0,o.Z)(e)}]},r.next=9,t.form.submit("post","/api/admin/files",i);case 9:l=r.sent,(u=l.data).success?(t.uploadedFilePath=u.path,t.imageBase64=n):t.error=u.message;case 12:case"end":return r.stop()}}),r)})),function(){var e=this,t=arguments;return new Promise((function(n,a){var s=r.apply(e,t);function i(e){l(s,n,a,i,o,"next",e)}function o(e){l(s,n,a,i,o,"throw",e)}i(void 0)}))})()}}}},41092:(e,r,t)=>{"use strict";t.d(r,{Z:()=>n});const n={props:["id","small"]}},32527:(e,r,t)=>{"use strict";var n=t(93379),a=t.n(n),s=t(24431),i={insert:"head",singleton:!1};a()(s.Z,i);s.Z.locals},79935:(e,r,t)=>{"use strict";t.d(r,{s:()=>n,x:()=>a});var n=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("v-text-field",{attrs:{value:e.path,label:e.label,disabled:e.disabled||e.form.busy,"append-icon":"mdi-paperclip","append-outer-icon":e.preview&&e.clearable?"mdi-delete":"",outlined:"",readonly:"",error:!!e.error,"error-messages":e.error},on:{"click:append":function(r){return e.$refs.input.click()},"click:append-outer":e.clear},scopedSlots:e._u([{key:"prepend-inner",fn:function(){return[t("v-avatar",{attrs:{height:"28",width:"auto","max-width":"56",tile:""},on:{click:function(r){!e.disabled&&e.$refs.input.click()}}},[e.isImage&&e.preview?t("img",{attrs:{src:e.preview,alt:e.label,disabled:e.disabled||e.form.busy}}):t("v-icon",{attrs:{disabled:e.disabled||e.form.busy}},[e._v("\n          mdi-image-outline\n        ")])],1)]},proxy:!0},{key:"append-outer",fn:function(){return[e._t("append-outer")]},proxy:!0}],null,!0)}),e._v(" "),t("input",{ref:"input",staticClass:"d-none",attrs:{type:"file",accept:e.accept},on:{change:e.uploadFile}})],1)},a=[]},96992:(e,r,t)=>{"use strict";t.d(r,{s:()=>n,x:()=>a});var n=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("v-menu",{attrs:{"offset-y":!0,transition:"scroll-y-transition",bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(r){var n=r.on;return[t("v-btn",e._g({attrs:{icon:""}},n),[t("v-icon",{attrs:{small:e.small}},[e._v("mdi-dots-vertical")])],1)]}}])},[e._v(" "),t("v-list",[t("v-list-item",{attrs:{to:{name:"users.show",params:{id:e.id}},exact:""}},[t("v-list-item-icon",[t("v-icon",{attrs:{small:e.small}},[e._v("mdi-account")])],1),e._v(" "),t("v-list-item-content",[t("v-list-item-title",[e._v(e._s(e.$t("Profile")))])],1)],1),e._v(" "),t("v-list-item",{attrs:{to:{name:"admin.users.show",params:{id:e.id}},exact:""}},[t("v-list-item-icon",[t("v-icon",{attrs:{small:e.small}},[e._v("mdi-eye")])],1),e._v(" "),t("v-list-item-content",[t("v-list-item-title",[e._v(e._s(e.$t("View")))])],1)],1),e._v(" "),t("v-list-item",{attrs:{to:{name:"admin.users.edit",params:{id:e.id}},exact:""}},[t("v-list-item-icon",[t("v-icon",{attrs:{small:e.small}},[e._v("mdi-pencil")])],1),e._v(" "),t("v-list-item-content",[t("v-list-item-title",[e._v(e._s(e.$t("Edit")))])],1)],1),e._v(" "),t("v-list-item",{attrs:{to:{name:"admin.users.delete",params:{id:e.id}},exact:""}},[t("v-list-item-icon",[t("v-icon",{attrs:{small:e.small}},[e._v("mdi-delete")])],1),e._v(" "),t("v-list-item-content",[t("v-list-item-title",[e._v(e._s(e.$t("Delete")))])],1)],1),e._v(" "),t("v-list-item",{attrs:{to:{name:"admin.users.mail",params:{id:e.id}},exact:""}},[t("v-list-item-icon",[t("v-icon",{attrs:{small:e.small}},[e._v("mdi-email-outline")])],1),e._v(" "),t("v-list-item-content",[t("v-list-item-title",[e._v(e._s(e.$t("E-mail")))])],1)],1)],1)],1)},a=[]},98668:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>D});var n=t(87757),a=t.n(n),s=t(9669),i=t.n(s),o=t(50175),l=t.n(o),u=t(18623),d=t(95792),c=t(69010);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,r,t,n,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void t(e)}o.done?r(l):Promise.resolve(l).then(n,a)}function p(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var s=e.apply(r,t);function i(e){f(s,n,a,i,o,"next",e)}function o(e){f(s,n,a,i,o,"throw",e)}i(void 0)}))}}function v(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?v(Object(t),!0).forEach((function(r){b(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function b(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const y={components:{FileUpload:t(31778).Z,Preloader:c.Z,UserMenu:d.Z},mixins:[u.Z],middleware:["auth","verified","2fa_passed","admin"],props:["id"],metaInfo:function(){return{title:this.$t("User {0}",[this.id])}},data:function(){return{user:null,roles:[],accessModes:[],permissions:{},individualPermissions:!1,showPassword:!1,form:new(l())({name:null,email:null,role:null,permissions:null,avatar:null,status:null,hide_profit:null,banned_from_chat:null})}},computed:{changed:function(){var e=this;return this.form.keys().some((function(r){return e.user&&e.form[r]!==e.user[r]}))}},watch:{individualPermissions:function(e){e&&!this.form.permissions?this.form.permissions=h({},Object.keys(this.permissions).reduce((function(e,r){return h(h({},e),{},b({},r,0))}),{})):e||(this.form.permissions=null)},"form.role":function(e){2!==e&&(this.individualPermissions=!1)}},created:function(){var e=this;return p(a().mark((function r(){var t,n;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i().get("/api/admin/users/".concat(e.id));case 2:t=r.sent,n=t.data,e.user=n.user,e.roles=Object.keys(n.roles).map((function(e){return{value:parseInt(e,10),text:n.roles[e]}})),e.accessModes=Object.keys(n.access_modes).map((function(e){return{value:parseInt(e,10),text:n.access_modes[e]}})),e.permissions=n.permissions,e.user.permissions&&(e.individualPermissions=!0),e.form.keys().forEach((function(r){var t=e.user[r];e.form[r]=null!==t&&"object"===m(t)?h({},t):t}));case 10:case"end":return r.stop()}}),r)})))()},methods:{update:function(){var e=this;return p(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.form.patch("/api/admin/users/".concat(e.id));case 2:e.$store.dispatch("message/success",{text:e.$t("User successfully updated.")}),e.$router.push({name:"admin.users.index"});case 4:case"end":return r.stop()}}),r)})))()}}};var g=t(51900),_=t(43453),w=t.n(_),x=t(4330),k=t(43776),P=t(5255),$=t(17024),F=t(66530),V=t(83240),j=t(6571),O=t(57894),Z=t(9047),S=t(55515),B=t(22515),q=t(13234),C=t(54933),E=t(40961),I=t(73845),A=(0,g.Z)(y,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("v-container",[t("v-row",{attrs:{align:"center",justify:"center"}},[t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-card",[t("v-toolbar",[t("v-btn",{attrs:{icon:""},on:{click:function(r){return e.$router.go(-1)}}},[t("v-icon",[e._v("mdi-arrow-left")])],1),e._v(" "),t("v-toolbar-title",[e._v("\n            "+e._s(e.$t("User {0}",[e.id]))+"\n          ")]),e._v(" "),t("v-spacer"),e._v(" "),t("user-menu",{attrs:{id:e.id}}),e._v(" "),t("preloader",{attrs:{active:!e.user}})],1),e._v(" "),t("v-card-text",[t("v-form",{on:{submit:function(r){return r.preventDefault(),e.update(r)}},model:{value:e.formIsValid,callback:function(r){e.formIsValid=r},expression:"formIsValid"}},[t("v-text-field",{attrs:{label:e.$t("Name"),type:"text",disabled:e.form.busy||!e.user,rules:[e.validationRequired],error:e.form.errors.has("name"),"error-messages":e.form.errors.get("name"),outlined:""},on:{keydown:function(r){return e.clearFormErrors(r,"name")}},model:{value:e.form.name,callback:function(r){e.$set(e.form,"name",r)},expression:"form.name"}}),e._v(" "),t("v-text-field",{attrs:{label:e.$t("Email"),type:"email",disabled:e.form.busy||!e.user,rules:[e.validationRequired,e.validationEmail],error:e.form.errors.has("email"),"error-messages":e.form.errors.get("email"),outlined:""},on:{keydown:function(r){return e.clearFormErrors(r,"email")}},model:{value:e.form.email,callback:function(r){e.$set(e.form,"email",r)},expression:"form.email"}}),e._v(" "),t("v-select",{attrs:{items:e.roles,label:e.$t("Role"),disabled:e.form.busy||!e.user,error:e.form.errors.has("role"),"error-messages":e.form.errors.get("role"),outlined:""},model:{value:e.form.role,callback:function(r){e.$set(e.form,"role",r)},expression:"form.role"}}),e._v(" "),2===e.form.role?t("v-switch",{staticClass:"mb-5",attrs:{label:e.$t("Individual permissions"),color:"primary",disabled:e.form.busy||!e.user},model:{value:e.individualPermissions,callback:function(r){e.individualPermissions=r},expression:"individualPermissions"}}):e._e(),e._v(" "),2===e.form.role&&e.individualPermissions?t("v-card",{staticClass:"mb-10",attrs:{outlined:""}},[t("v-card-title",{staticClass:"font-weight-thin"},[e._v("\n                "+e._s(e.$t("Permissions"))+"\n              ")]),e._v(" "),t("v-card-text",e._l(e.permissions,(function(r,n){return t("v-row",{key:n,staticClass:"align-center"},[t("v-col",{attrs:{cols:"6"}},[e._v("\n                    "+e._s(r)+"\n                  ")]),e._v(" "),t("v-col",{attrs:{cols:"6"}},[null!==e.form.permissions?t("v-select",{attrs:{items:e.accessModes,label:e.$t("Access"),"hide-details":"",dense:"",outlined:""},model:{value:e.form.permissions[n],callback:function(r){e.$set(e.form.permissions,n,r)},expression:"form.permissions[id]"}}):e._e()],1)],1)})),1)],1):e._e(),e._v(" "),e.user?t("file-upload",{attrs:{label:e.$t("Avatar"),name:e.user.id.toString(),path:"/storage/avatars",folder:"avatars"},model:{value:e.form.avatar,callback:function(r){e.$set(e.form,"avatar",r)},expression:"form.avatar"}}):e._e(),e._v(" "),t("v-text-field",{attrs:{label:e.$t("Password"),"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password",disabled:e.form.busy||!e.user,error:e.form.errors.has("password"),"error-messages":e.form.errors.get("password"),hint:e.$t("Leave empty to preserve current user password."),"persistent-hint":"",outlined:"",counter:!0},on:{"click:append":function(r){e.showPassword=!e.showPassword},keydown:function(r){return e.clearFormErrors(r,"password")}},model:{value:e.form.password,callback:function(r){e.$set(e.form,"password",r)},expression:"form.password"}}),e._v(" "),t("v-switch",{attrs:{label:e.$t("Blocked"),color:"primary",disabled:e.form.busy||!e.user,"false-value":0,"true-value":1},model:{value:e.form.status,callback:function(r){e.$set(e.form,"status",r)},expression:"form.status"}}),e._v(" "),t("v-switch",{attrs:{label:e.$t("Hide profit"),color:"primary",disabled:e.form.busy||!e.user,"false-value":!1,"true-value":!0},model:{value:e.form.hide_profit,callback:function(r){e.$set(e.form,"hide_profit",r)},expression:"form.hide_profit"}}),e._v(" "),t("v-switch",{attrs:{label:e.$t("Banned from chat"),color:"primary",disabled:e.form.busy||!e.user,"false-value":!1,"true-value":!0},model:{value:e.form.banned_from_chat,callback:function(r){e.$set(e.form,"banned_from_chat",r)},expression:"form.banned_from_chat"}}),e._v(" "),t("v-skeleton-loader",{attrs:{type:"button",loading:!e.user}},[t("v-btn",{attrs:{type:"submit",color:"primary",disabled:!e.formIsValid||!e.changed||e.form.busy,loading:e.form.busy}},[e._v("\n                "+e._s(e.$t("Save"))+"\n              ")])],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);const D=A.exports;w()(A,{VBtn:x.Z,VCard:k.Z,VCardText:P.ZB,VCardTitle:P.EB,VCol:$.Z,VContainer:F.Z,VForm:V.Z,VIcon:j.Z,VRow:O.Z,VSelect:Z.Z,VSkeletonLoader:S.Z,VSpacer:B.Z,VSwitch:q.Z,VTextField:C.Z,VToolbar:E.Z,VToolbarTitle:I.qW})}}]);
//# sourceMappingURL=admin-users-edit.js.map