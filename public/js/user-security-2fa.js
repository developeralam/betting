(self.webpackChunk=self.webpackChunk||[]).push([[1599],{88379:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var o=r(87757),n=r.n(o),s=r(50175),a=r.n(s),i=r(18623),c=r(20629);function l(e,t,r,o,n,s,a){try{var i=e[s](a),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,n)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var s=e.apply(t,r);function a(e){l(s,o,n,a,i,"next",e)}function i(e){l(s,o,n,a,i,"throw",e)}a(void 0)}))}}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const p={mixins:[i.Z],metaInfo:function(){return{title:this.$t("Two-factor authentication")}},data:function(){return{showPassword:!1,disablingFormIsValid:null,confirmationFormIsValid:null,enablingForm:new(a()),disablingForm:new(a()),confirmationForm:new(a())({secret:"",one_time_password:""}),qr:null,displayDisablingForm:!1}},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},(0,c.rn)("auth",["user"])),methods:{enable:function(){var e=this;return u(n().mark((function t(){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.enablingForm.post("/api/user/security/2fa/enable");case 2:r=t.sent,o=r.data,e.qr=o.qr,e.confirmationForm.secret=o.secret;case 6:case"end":return t.stop()}}),t)})))()},confirm:function(){var e=this;return u(n().mark((function t(){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.confirmationForm.post("/api/user/security/2fa/confirm");case 2:r=t.sent,o=r.data,e.$store.dispatch("auth/updateUser",o),e.qr=null,e.$store.dispatch("message/success",{text:e.$t("Two-factor authentication successfully enabled.")});case 7:case"end":return t.stop()}}),t)})))()},disable:function(){var e=this;return u(n().mark((function t(){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.disablingForm.post("/api/user/security/2fa/disable");case 2:r=t.sent,o=r.data,e.$store.dispatch("auth/updateUser",o),e.$store.dispatch("message/success",{text:e.$t("Two-factor authentication successfully disabled.")});case 6:case"end":return t.stop()}}),t)})))()}}};var f=r(51900),b=r(43453),v=r.n(b),w=r(4330),_=r(43776),h=r(5255),g=r(17024),y=r(66530),F=r(83240),x=r(57894),$=r(54933),O=r(40961),V=r(73845),k=(0,f.Z)(p,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-row",{attrs:{justify:"center"}},[r("v-col",{attrs:{cols:"12",sm:"8",md:"6",lg:"4"}},[r("v-card",[r("v-toolbar",[r("v-toolbar-title",[e._v("\n            "+e._s(e.$t("Two-factor authentication"))+"\n          ")])],1),e._v(" "),e.user.two_factor_auth_enabled&&e.user.two_factor_auth_passed?[e.displayDisablingForm?[r("v-card-text",[r("p",[e._v("\n                "+e._s(e.$t("Please fill in the below form to disable two-factor authentication."))+"\n              ")]),e._v(" "),r("v-form",{on:{submit:function(t){return t.preventDefault(),e.disable(t)}},model:{value:e.disablingFormIsValid,callback:function(t){e.disablingFormIsValid=t},expression:"disablingFormIsValid"}},[0==e.user.profiles.length?r("v-text-field",{attrs:{label:e.$t("Current password"),"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password",name:"password",rules:[e.validationRequired],error:e.disablingForm.errors.has("password"),"error-messages":e.disablingForm.errors.get("password"),outlined:"",counter:""},on:{"click:append":function(t){e.showPassword=!e.showPassword},keydown:function(t){return e.clearFormErrors(t,"password",e.disablingForm)}},model:{value:e.disablingForm.password,callback:function(t){e.$set(e.disablingForm,"password",t)},expression:"disablingForm.password"}}):e._e(),e._v(" "),r("v-text-field",{attrs:{label:e.$t("One-time password"),type:"text",name:"one_time_password",rules:[e.validationRequired,function(t){return e.validationMinLength(t,6)}],error:e.disablingForm.errors.has("one_time_password"),"error-messages":e.disablingForm.errors.get("one_time_password"),outlined:""},on:{keydown:function(t){return e.clearFormErrors(t,"one_time_password",e.disablingForm)}},model:{value:e.disablingForm.one_time_password,callback:function(t){e.$set(e.disablingForm,"one_time_password",t)},expression:"disablingForm.one_time_password"}}),e._v(" "),r("v-btn",{attrs:{type:"submit",color:"primary",disabled:!e.disablingFormIsValid||e.disablingForm.busy,loading:e.disablingForm.busy}},[e._v("\n                  "+e._s(e.$t("Confirm"))+"\n                ")])],1)],1)]:[r("v-card-text",[r("p",[e._v("\n                "+e._s(e.$t("Two-factor authentication is currently enabled."))+"\n              ")]),e._v(" "),r("v-btn",{attrs:{color:"primary"},on:{click:function(t){e.displayDisablingForm=!e.displayDisablingForm}}},[e._v(e._s(e.$t("Disable")))])],1)]]:[e.qr?[r("v-card-text",[r("p",[e._v(e._s(e.$t("Please do the following to enable two-factor authentication.")))]),e._v(" "),r("ul",[r("li",[e._v(e._s(e.$t("Open Google Authenticator app on your mobile phone.")))]),e._v(" "),r("li",[e._v(e._s(e.$t("Scan the below QR code with the authenticator app.")))]),e._v(" "),r("li",[e._v(e._s(e.$t("After that input the one-time password that you see on the screen to complete the process.")))])]),e._v(" "),r("div",{staticClass:"my-5 text-center",domProps:{innerHTML:e._s(e.qr)}}),e._v(" "),r("v-form",{on:{submit:function(t){return t.preventDefault(),e.confirm(t)}},model:{value:e.confirmationFormIsValid,callback:function(t){e.confirmationFormIsValid=t},expression:"confirmationFormIsValid"}},[r("v-text-field",{attrs:{label:e.$t("One-time password"),type:"text",name:"one_time_password",rules:[e.validationRequired,function(t){return e.validationMinLength(t,6)}],error:e.confirmationForm.errors.has("one_time_password"),"error-messages":e.confirmationForm.errors.get("one_time_password"),outlined:""},on:{keydown:function(t){return e.clearFormErrors(t,"one_time_password",e.confirmationForm)}},model:{value:e.confirmationForm.one_time_password,callback:function(t){e.$set(e.confirmationForm,"one_time_password",t)},expression:"confirmationForm.one_time_password"}}),e._v(" "),r("v-btn",{attrs:{type:"submit",color:"primary",disabled:!e.confirmationFormIsValid||e.confirmationForm.busy,loading:e.confirmationForm.busy}},[e._v("\n                  "+e._s(e.$t("Confirm"))+"\n                ")])],1)],1)]:[r("v-card-text",[r("p",[e._v("\n              "+e._s(e.$t("2-step verification provides stronger security for your account by requiring a second step of verification when you sign in."))+"\n              "+e._s(e.$t("In addition to your password, you will also need a code generated by the Google Authenticator app on your phone."))+"\n              "+e._s(e.$t("It is strongly recommended to enable two-factor authentication to protect your account."))+"\n              ")]),e._v(" "),r("v-btn",{attrs:{color:"primary",disabled:e.enablingForm.busy,loading:e.enablingForm.busy},on:{click:e.enable}},[e._v(e._s(e.$t("Enable")))])],1)]]],2)],1)],1)],1)}),[],!1,null,null,null);const P=k.exports;v()(k,{VBtn:w.Z,VCard:_.Z,VCardText:h.ZB,VCol:g.Z,VContainer:y.Z,VForm:F.Z,VRow:x.Z,VTextField:$.Z,VToolbar:O.Z,VToolbarTitle:V.qW})}}]);
//# sourceMappingURL=user-security-2fa.js.map