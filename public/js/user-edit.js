(self.webpackChunk=self.webpackChunk||[]).push([[2879],{69378:(e,r,t)=>{"use strict";function a(e){return Array.isArray(e)}function n(e,r,t){return r=r||new FormData,void 0===e||(a(e)?e.forEach((function(e){n(e,r,t+"[]")})):!function(e){return e===Object(e)}(e)||function(e){return e instanceof File}(e)||function(e){return e instanceof Date}(e)?r.append(t,e):Object.keys(e).forEach((function(i){var o=e[i];if(a(o))for(;i.length>2&&i.lastIndexOf("[]")===i.length-2;)i=i.substring(0,i.length-2);n(o,r,t?t+"["+i+"]":i)}))),r}t.d(r,{Z:()=>n})},45350:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});var a=t(94015),n=t.n(a),i=t(23645),o=t.n(i)()(n());o.push([e.id,".v-avatar[data-v-0b49606c]{cursor:pointer}","",{version:3,sources:["webpack://./resources/js/components/ImageUpload.vue"],names:[],mappings:"AAwEA,2BACA,cACA",sourcesContent:['<template>\r\n  <div>\r\n    <v-text-field\r\n      :value="value"\r\n      :label="label"\r\n      append-icon="mdi-paperclip"\r\n      outlined\r\n      readonly\r\n      :error="formImagePropertyName && form.errors.has(formImagePropertyName)"\r\n      :error-messages="formImagePropertyName ? form.errors.get(formImagePropertyName) : \'\'"\r\n      @click:append="$refs.fileInput.click()"\r\n    >\r\n      <template v-if="preview" v-slot:prepend-inner>\r\n        <v-avatar size="28" tile @click="$refs.fileInput.click()">\r\n          <img :src="preview" :alt="label" />\r\n        </v-avatar>\r\n      </template>\r\n    </v-text-field>\r\n\r\n    <input ref="fileInput" type="file" class="d-none" accept="image/*" @change="setImage">\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \'ImageUpload\',\r\n\r\n  props: [\'label\', \'form\', \'formImagePropertyName\', \'defaultValue\', \'defaultUrl\'],\r\n\r\n  data () {\r\n    return {\r\n      image: null,\r\n      imageBase64: null\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    value () {\r\n      return this.image ? this.image.name : (this.defaultValue || this.$t(\'Upload a new image\'))\r\n    },\r\n    preview () {\r\n      return this.imageBase64 || this.defaultUrl\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    setImage (event) {\r\n      const image = event.target.files[0]\r\n\r\n      // if uploaded file is an image\r\n      if (image && image.type.match(/^image\\/.*/)) {\r\n        if (this.formImagePropertyName) {\r\n          this.form.errors.clear(this.formImagePropertyName)\r\n        }\r\n\r\n        this.image = image\r\n\r\n        var reader = new FileReader()\r\n\r\n        // define a callback function to run, when FileReader finishes its job\r\n        reader.onload = e => { this.imageBase64 = e.target.result }\r\n\r\n        // Start the reader job - read file as a data url (base64 format)\r\n        reader.readAsDataURL(image)\r\n\r\n        this.$emit(\'change\', image)\r\n      }\r\n    }\r\n  }\r\n}\r\n<\/script>\r\n<style scoped>\r\n.v-avatar {\r\n  cursor: pointer;\r\n}\r\n</style>\r\n'],sourceRoot:""}]);const s=o},25943:(e,r,t)=>{"use strict";t.d(r,{Z:()=>a});const a={name:"ImageUpload",props:["label","form","formImagePropertyName","defaultValue","defaultUrl"],data:function(){return{image:null,imageBase64:null}},computed:{value:function(){return this.image?this.image.name:this.defaultValue||this.$t("Upload a new image")},preview:function(){return this.imageBase64||this.defaultUrl}},methods:{setImage:function(e){var r=this,t=e.target.files[0];if(t&&t.type.match(/^image\/.*/)){this.formImagePropertyName&&this.form.errors.clear(this.formImagePropertyName),this.image=t;var a=new FileReader;a.onload=function(e){r.imageBase64=e.target.result},a.readAsDataURL(t),this.$emit("change",t)}}}}},92061:(e,r,t)=>{"use strict";var a=t(93379),n=t.n(a),i=t(45350),o={insert:"head",singleton:!1};n()(i.Z,o);i.Z.locals},83759:(e,r,t)=>{"use strict";t.d(r,{s:()=>a,x:()=>n});var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("v-text-field",{attrs:{value:e.value,label:e.label,"append-icon":"mdi-paperclip",outlined:"",readonly:"",error:e.formImagePropertyName&&e.form.errors.has(e.formImagePropertyName),"error-messages":e.formImagePropertyName?e.form.errors.get(e.formImagePropertyName):""},on:{"click:append":function(r){return e.$refs.fileInput.click()}},scopedSlots:e._u([e.preview?{key:"prepend-inner",fn:function(){return[t("v-avatar",{attrs:{size:"28",tile:""},on:{click:function(r){return e.$refs.fileInput.click()}}},[t("img",{attrs:{src:e.preview,alt:e.label}})])]},proxy:!0}:null],null,!0)}),e._v(" "),t("input",{ref:"fileInput",staticClass:"d-none",attrs:{type:"file",accept:"image/*"},on:{change:e.setImage}})],1)},n=[]},91666:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>E});var a=t(87757),n=t.n(a),i=t(50175),o=t.n(i),s=t(18623),l=t(24790),u=t(20629),m=t(69378);function c(e,r,t,a,n,i,o){try{var s=e[i](o),l=s.value}catch(e){return void t(e)}s.done?r(l):Promise.resolve(l).then(a,n)}function f(e){return function(){var r=this,t=arguments;return new Promise((function(a,n){var i=e.apply(r,t);function o(e){c(i,a,n,o,s,"next",e)}function s(e){c(i,a,n,o,s,"throw",e)}o(void 0)}))}}function p(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,a)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?p(Object(t),!0).forEach((function(r){v(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function v(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const g={components:{ImageUpload:l.Z},mixins:[s.Z],middleware:["auth","verified","2fa_passed"],metaInfo:function(){return{title:this.$t("Profile")}},data:function(){return{form:new(o())({name:null,email:null,hide_profit:null}),emailVerificationForm:new(o())}},computed:d(d({},(0,u.rn)("auth",["user"])),{},{changed:function(){var e=this;return this.form.keys().some((function(r){return e.form[r]!==e.user[r]}))}}),created:function(){var e=this;this.form.keys().forEach((function(r){e.form[r]=e.user[r]}))},methods:{changeAvatar:function(e){this.$set(this.form,"avatar",e)},verifyEmail:function(){var e=this;return f(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.emailVerificationForm.submit("post","/api/email/resend");case 2:e.$store.dispatch("message/success",{text:e.$t("A fresh verification link has been sent to your email address.")});case 3:case"end":return r.stop()}}),r)})))()},update:function(){var e=this;return f(n().mark((function r(){var t,a,i;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.form.avatar?{transformRequest:[function(e,r){return(0,m.Z)(e)}]}:{},r.next=3,e.form.submit("post","/api/user/update",t);case 3:a=r.sent,i=a.data,e.$store.dispatch("auth/updateUser",i),e.$store.dispatch("message/success",{text:e.$t("Data successfully updated.")});case 7:case"end":return r.stop()}}),r)})))()}}};var h=t(51900),y=t(43453),b=t.n(y),w=t(4330),I=t(43776),k=t(5255),_=t(17024),x=t(66530),P=t(83240),$=t(6571),V=t(57894),O=t(13234),Z=t(54933),j=t(40961),A=t(73845),N=(0,h.Z)(g,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("v-container",{attrs:{fluid:""}},[t("v-row",{attrs:{align:"center",justify:"center"}},[t("v-col",{attrs:{cols:"12",sm:"8",md:"6",lg:"4"}},[t("v-card",[t("v-toolbar",[t("v-toolbar-title",[e._v("\n            "+e._s(e.$t("Profile"))+"\n          ")])],1),e._v(" "),t("v-card-text",[t("v-form",{on:{submit:function(r){return r.preventDefault(),e.update(r)}},model:{value:e.formIsValid,callback:function(r){e.formIsValid=r},expression:"formIsValid"}},[t("v-text-field",{attrs:{label:e.$t("Name"),type:"text",name:"name",rules:[e.validationRequired],error:e.form.errors.has("name"),"error-messages":e.form.errors.get("name"),outlined:""},on:{keydown:function(r){return e.clearFormErrors(r,"name")}},model:{value:e.form.name,callback:function(r){e.$set(e.form,"name",r)},expression:"form.name"}}),e._v(" "),t("v-text-field",{attrs:{label:e.$t("Email"),type:"email",name:"email",rules:[e.validationRequired,e.validationEmail],error:e.form.errors.has("email"),"error-messages":e.form.errors.get("email"),disabled:!!e.user.email_verified_at,outlined:""},on:{keydown:function(r){return e.clearFormErrors(r,"email")}},scopedSlots:e._u([{key:"append",fn:function(){return[e.user.email_verified_at?t("v-icon",{attrs:{color:"success"}},[e._v("\n                  mdi-check\n                ")]):t("v-btn",{staticClass:"mt-n2",attrs:{text:"",loading:e.emailVerificationForm.busy},on:{click:e.verifyEmail}},[e._v("\n                  "+e._s(e.$t("Verify"))+"\n                ")])]},proxy:!0}]),model:{value:e.form.email,callback:function(r){e.$set(e.form,"email",r)},expression:"form.email"}}),e._v(" "),t("image-upload",{attrs:{label:e.$t("Avatar"),form:e.form,"form-image-property-name":"avatar","default-value":e.user.avatar,"default-url":e.user.avatar_url},on:{change:e.changeAvatar}}),e._v(" "),t("v-switch",{attrs:{label:e.$t("Hide profit"),color:"primary","false-value":!1,"true-value":!0},model:{value:e.form.hide_profit,callback:function(r){e.$set(e.form,"hide_profit",r)},expression:"form.hide_profit"}}),e._v(" "),t("v-btn",{attrs:{type:"submit",color:"primary",disabled:!e.formIsValid||!e.changed||e.form.busy,loading:e.form.busy}},[e._v("\n              "+e._s(e.$t("Save"))+"\n            ")])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);const E=N.exports;b()(N,{VBtn:w.Z,VCard:I.Z,VCardText:k.ZB,VCol:_.Z,VContainer:x.Z,VForm:P.Z,VIcon:$.Z,VRow:V.Z,VSwitch:O.Z,VTextField:Z.Z,VToolbar:j.Z,VToolbarTitle:A.qW})}}]);
//# sourceMappingURL=user-edit.js.map